using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using Newtonsoft.Json.Linq;
using NPOI.SS.UserModel;
using PPPayReportTools.Excel;
using System.Collections.Generic;
using System.Linq;

namespace WebApplication1.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class BaodanController : ControllerBase
    {
        private ExcelHelper _excelHelper;
        private ILogger _logger;
        private object _obj = new object();

        public BaodanController(
            ExcelHelper excelHelper,
            ILogger<TestController> logger)
        {
            this._excelHelper = excelHelper;
            this._logger = logger;
        }

        /// <summary>
        /// 保单数据整理
        /// api/baodan/updatebd
        /// </summary>
        /// <returns></returns>
        [Route("UpdateBD")]
        [HttpGet]
        public void UpdateBD()
        {
            string filePath = @"C:\Users\lixianghong\Desktop\12月份保单.xlsx";
            List<Baodan> bdList = this._excelHelper.ReadTitleDataList<Baodan>(filePath, new ExcelFileDescription());

            string bdDetailListStr = "[{\"bdNo\":\"210012152337011\",\"tbrPhone\":\"13213101207\",\"bbrPhone\":\"13213101207\",\"bbrName\":\"陈艺然\"},{\"bdNo\":\"210012066114751\",\"tbrPhone\":null,\"bbrPhone\":\"15539083133,15539083133,15539083133\",\"bbrName\":\"高 一霖\"},{\"bdNo\":\"210012067935171\",\"tbrPhone\":\"13914128886\",\"bbrPhone\":\"13861720886,13861720886,13861720886\",\"bbrName\":\"赵磊\"},{\"bdNo\":\"210012069242591\",\"tbrPhone\":\"15239949994,\",\"bbrPhone\":\"18623870830\",\"bbrName\":\"王 乾任\"},{\"bdNo\":\"210062224374945\",\"tbrPhone\":\"18736777187\",\"bbrPhone\":\"18736777187\",\"bbrName\":\"张哲鸣\"},{\"bdNo\":\"210012152351721\",\"tbrPhone\":\"15090537349\",\"bbrPhone\":\"15090537349\",\"bbrName\":\"洪若彤\"},{\"bdNo\":\"210081444274164\",\"tbrPhone\":\"13837001121,15824700277,\",\"bbrPhone\":\"15824700277\",\"bbrName\":\"屈 远航\"},{\"bdNo\":\"210081444201049\",\"tbrPhone\":\"13569326352\",\"bbrPhone\":\"13569326352\",\"bbrName\":\"李岁虎\"},{\"bdNo\":\"210081444200521\",\"tbrPhone\":\"13569326352\",\"bbrPhone\":\"13569326352\",\"bbrName\":\"李岁虎\"},{\"bdNo\":\"210081444471472\",\"tbrPhone\":\"18737025960\",\"bbrPhone\":\"18737025960\",\"bbrName\":\"刘 晟宇\"},{\"bdNo\":\"210081444457243\",\"tbrPhone\":null,\"bbrPhone\":\"19913252520\",\"bbrName\":\"崔 俊豪\"},{\"bdNo\":\"210081444331278\",\"tbrPhone\":\"15139711651,15090592747,15090592747,\",\"bbrPhone\":\"15139711651,15090592747,15139711651,15090592747,15090592747\",\"bbrName\":\"翟 晓玲\"},{\"bdNo\":\"210081444471486\",\"tbrPhone\":\"18737025960\",\"bbrPhone\":\"18737025960\",\"bbrName\":\"刘 晟宇\"},{\"bdNo\":\"210081444578840\",\"tbrPhone\":\"03705188381\",\"bbrPhone\":\"15136068882\",\"bbrName\":\"张 薰儿\"},{\"bdNo\":\"210081444578855\",\"tbrPhone\":\"03705188381\",\"bbrPhone\":\"15136068882\",\"bbrName\":\"张 薰儿\"},{\"bdNo\":\"210081444529428\",\"tbrPhone\":\"18137067315,18137067315,\",\"bbrPhone\":\"13837070019,18137067315,18137067315\",\"bbrName\":\"李 德雷\"},{\"bdNo\":\"210081444722166\",\"tbrPhone\":null,\"bbrPhone\":\"13523165211\",\"bbrName\":\"刘艳红\"},{\"bdNo\":\"210081505980043\",\"tbrPhone\":\"5210031,5228031,13781673923,\",\"bbrPhone\":\"5210031,5228031,13781673923\",\"bbrName\":\"邸 书芹\"},{\"bdNo\":\"210081505601420\",\"tbrPhone\":\"13523828300,\",\"bbrPhone\":\"13523828300\",\"bbrName\":\"黄 毛香\"},{\"bdNo\":\"210081505992926\",\"tbrPhone\":\"15938321278,\",\"bbrPhone\":\"15938321278\",\"bbrName\":\"吴 增光\"},{\"bdNo\":\"210081506054897\",\"tbrPhone\":\"18338727107,\",\"bbrPhone\":\"18338727107\",\"bbrName\":\"邵 启博\"},{\"bdNo\":\"210081506315306\",\"tbrPhone\":null,\"bbrPhone\":\"13353600987,18736700027,18736700027,18736700027\",\"bbrName\":\"付远\"},{\"bdNo\":\"210081506456322\",\"tbrPhone\":null,\"bbrPhone\":\"18337177798\",\"bbrName\":\"张 璐\"},{\"bdNo\":\"210081506338435\",\"tbrPhone\":\"15139722281\",\"bbrPhone\":\"15139722281\",\"bbrName\":\"刘 于墨\"},{\"bdNo\":\"210081506666706\",\"tbrPhone\":null,\"bbrPhone\":\"15993411748\",\"bbrName\":\"蒋 保平\"},{\"bdNo\":\"210082008645800\",\"tbrPhone\":\"15225222280\",\"bbrPhone\":\"15225222280\",\"bbrName\":\"王 园园\"},{\"bdNo\":\"210081506718618\",\"tbrPhone\":null,\"bbrPhone\":\"15136061811,15938307996\",\"bbrName\":\"黄 传山\"},{\"bdNo\":\"210081506710867\",\"tbrPhone\":\"18237000841,\",\"bbrPhone\":\"18237000841\",\"bbrName\":\"赵 子茗\"},{\"bdNo\":\"210082107436619\",\"tbrPhone\":\"17739001770\",\"bbrPhone\":\"17739001770\",\"bbrName\":\"刘 玺润\"},{\"bdNo\":\"210082009209352\",\"tbrPhone\":null,\"bbrPhone\":\"18736856752,15212621950\",\"bbrName\":\"王 炫博\"},{\"bdNo\":\"210082009232526\",\"tbrPhone\":\"18838581898\",\"bbrPhone\":\"18838581898\",\"bbrName\":\"贾芳真\"},{\"bdNo\":\"210082107595050\",\"tbrPhone\":\"13213101207\",\"bbrPhone\":\"13213101207\",\"bbrName\":\"陈艺然\"},{\"bdNo\":\"210082008970733\",\"tbrPhone\":\"13395572441,0,\",\"bbrPhone\":\"15225270979,13395572441,0\",\"bbrName\":\"孟 庆云\"},{\"bdNo\":\"210082204221192\",\"tbrPhone\":\"18738092888\",\"bbrPhone\":\"18738092888,18236388999,18236388999\",\"bbrName\":\"刘鹤\"},{\"bdNo\":\"210082204222326\",\"tbrPhone\":\"18738092888\",\"bbrPhone\":\"18738092888,19913236777\",\"bbrName\":\"刘翼溥\"},{\"bdNo\":\"210091EL75A8992\",\"tbrPhone\":\"15236856100,\",\"bbrPhone\":\"18238738008,15236856100\",\"bbrName\":\"侯 玉春\"},{\"bdNo\":\"210082204248484\",\"tbrPhone\":\"18238082825\",\"bbrPhone\":\"18238082825\",\"bbrName\":\"张宛宛\"},{\"bdNo\":\"390011642840981\",\"tbrPhone\":\"15896991259,\",\"bbrPhone\":\"15896991259\",\"bbrName\":\"张 峻祎\"},{\"bdNo\":\"390011642840982\",\"tbrPhone\":\"15896991259,\",\"bbrPhone\":\"15896991259\",\"bbrName\":\"张 峻祎\"},{\"bdNo\":\"390011642209152\",\"tbrPhone\":null,\"bbrPhone\":\"13333705220\",\"bbrName\":\"刘 紫毅\"},{\"bdNo\":\"390011743342381\",\"tbrPhone\":\"13598386717,\",\"bbrPhone\":\"18137071088,13598386717\",\"bbrName\":\"张 婷\"},{\"bdNo\":\"390011745177741\",\"tbrPhone\":\"15237088466\",\"bbrPhone\":\"15237088466\",\"bbrName\":\"聂 梦\"},{\"bdNo\":\"390011969157011\",\"tbrPhone\":null,\"bbrPhone\":\"13703702011,15737065833\",\"bbrName\":\"王 政珺\"},{\"bdNo\":\"390011970642201\",\"tbrPhone\":\"15238505773\",\"bbrPhone\":\"15238505773,15238505773,15238505773\",\"bbrName\":\"刘 娜\"},{\"bdNo\":\"390081608049732\",\"tbrPhone\":null,\"bbrPhone\":\"13353600987,18736700027,18736700027,18736700027\",\"bbrName\":\"付远\"},{\"bdNo\":\"390081608249718\",\"tbrPhone\":\"13781564093,\",\"bbrPhone\":\"13781564093,13781564093\",\"bbrName\":\"庞松\"},{\"bdNo\":\"390081608482165\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"18211659137\",\"bbrName\":\"程 丽元\"},{\"bdNo\":\"390081608482487\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"18211659137\",\"bbrName\":\"程 丽元\"},{\"bdNo\":\"390081608055915\",\"tbrPhone\":null,\"bbrPhone\":\"15737095153\",\"bbrName\":\"郑高苹\"},{\"bdNo\":\"390081608505388\",\"tbrPhone\":\"15937026168,\",\"bbrPhone\":\"15937026168\",\"bbrName\":\"岳 群\"},{\"bdNo\":\"390081608505480\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"13781561488,13781561488\",\"bbrName\":\"程 梓桐\"},{\"bdNo\":\"390081608505500\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"13781516488,13781561488,13781561488,5180669\",\"bbrName\":\"郑 秀平\"},{\"bdNo\":\"390081608842080\",\"tbrPhone\":null,\"bbrPhone\":\"18937088840,5181915,15839028335\",\"bbrName\":\"刘 爱玲\"},{\"bdNo\":\"390081608514324\",\"tbrPhone\":\"18738025197,18738025197,\",\"bbrPhone\":\"18738025197\",\"bbrName\":\"余 丹青\"},{\"bdNo\":\"390081609121265\",\"tbrPhone\":\"13937063390\",\"bbrPhone\":\"13937063390\",\"bbrName\":\"葛 秋芝\"},{\"bdNo\":\"390081609535644\",\"tbrPhone\":\"15896991259,\",\"bbrPhone\":\"15896991259\",\"bbrName\":\"洪 路\"},{\"bdNo\":\"390081609437836\",\"tbrPhone\":\"15839070929,\",\"bbrPhone\":\"5198969,15037035071\",\"bbrName\":\"金 雷杰\"},{\"bdNo\":\"390081609395230\",\"tbrPhone\":\"15238570044,\",\"bbrPhone\":\"15238570044\",\"bbrName\":\"时 若淇\"},{\"bdNo\":\"390081609615776\",\"tbrPhone\":null,\"bbrPhone\":\"15617085197\",\"bbrName\":\"郑 三菊\"},{\"bdNo\":\"390081609613738\",\"tbrPhone\":\"15978781408,\",\"bbrPhone\":\"13603911073\",\"bbrName\":\"郑 勇\"},{\"bdNo\":\"390081609726242\",\"tbrPhone\":\"15839092229,\",\"bbrPhone\":\"15839092229,15839092229\",\"bbrName\":\"穆 丽\"},{\"bdNo\":\"390081609887646\",\"tbrPhone\":\"13865924504,\",\"bbrPhone\":\"13865924504\",\"bbrName\":\"黄 子琪\"},{\"bdNo\":\"390081610079885\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"15136001567,13781561488\",\"bbrName\":\"程 晓甜\"},{\"bdNo\":\"390081610058703\",\"tbrPhone\":null,\"bbrPhone\":\"13608403799\",\"bbrName\":\"翟 美玲\"},{\"bdNo\":\"390081610143720\",\"tbrPhone\":\"15036668444,\",\"bbrPhone\":\"15036668444\",\"bbrName\":\"张 益鸣\"},{\"bdNo\":\"390081610162689\",\"tbrPhone\":null,\"bbrPhone\":\"15737095153\",\"bbrName\":\"胡潇文\"},{\"bdNo\":\"390081610251770\",\"tbrPhone\":null,\"bbrPhone\":\"18338781306\",\"bbrName\":\"陈 昭名\"},{\"bdNo\":\"390081610122454\",\"tbrPhone\":\"15836471777\",\"bbrPhone\":\"13683705099,15836471777\",\"bbrName\":\"马 梓皓\"},{\"bdNo\":\"390081610251810\",\"tbrPhone\":null,\"bbrPhone\":\"18338781306\",\"bbrName\":\"陈 怡霏\"},{\"bdNo\":\"390081610280474\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"13781561488,13781561488\",\"bbrName\":\"程 梓桐\"},{\"bdNo\":\"390081610280056\",\"tbrPhone\":null,\"bbrPhone\":\"15896948894\",\"bbrName\":\"黄 红军\"},{\"bdNo\":\"390081610287498\",\"tbrPhone\":\"13683709738\",\"bbrPhone\":\"13683709738\",\"bbrName\":\"李 梦涵\"},{\"bdNo\":\"390081710549009\",\"tbrPhone\":null,\"bbrPhone\":\"15138585290,18237098792\",\"bbrName\":\"常 孟丽\"},{\"bdNo\":\"390081710760823\",\"tbrPhone\":\"14788277231\",\"bbrPhone\":\"14788277231\",\"bbrName\":\"李 博贤\"},{\"bdNo\":\"390081710752691\",\"tbrPhone\":null,\"bbrPhone\":\"15518692259\",\"bbrName\":\"张 子轩\"},{\"bdNo\":\"390081710789802\",\"tbrPhone\":\"13781622099\",\"bbrPhone\":\"5116177,13700701008,5213707\",\"bbrName\":\"李 勇\"},{\"bdNo\":\"390081710846493\",\"tbrPhone\":\"15539091013\",\"bbrPhone\":\"15539091013\",\"bbrName\":\"张 秀玲\"},{\"bdNo\":\"390081710915347\",\"tbrPhone\":null,\"bbrPhone\":\"15303705059\",\"bbrName\":\"夏 古玥\"},{\"bdNo\":\"390081710803675\",\"tbrPhone\":\"18037755667\",\"bbrPhone\":\"18037755667\",\"bbrName\":\"王 劝\"},{\"bdNo\":\"390081710926331\",\"tbrPhone\":\"15938379321\",\"bbrPhone\":\"15938379321\",\"bbrName\":\"李 淑霞\"},{\"bdNo\":\"390081710917228\",\"tbrPhone\":\"13837578607\",\"bbrPhone\":\"13837578607\",\"bbrName\":\"杨礼华\"},{\"bdNo\":\"390081710832207\",\"tbrPhone\":\"15805610371,15805610371,15805610371,\",\"bbrPhone\":\"15805610371,15805610371,15805610371,15805610371,15839071546,15805610371\",\"bbrName\":\"侯羿辰\"},{\"bdNo\":\"390081710953914\",\"tbrPhone\":\"5181059,15136042222,\",\"bbrPhone\":\"18236350555\",\"bbrName\":\"刘 馨泽\"},{\"bdNo\":\"390081711260053\",\"tbrPhone\":\"5181059,15136042222,\",\"bbrPhone\":\"18236350555,15136042222,15238598765\",\"bbrName\":\"刘 园园\"},{\"bdNo\":\"390081711307430\",\"tbrPhone\":null,\"bbrPhone\":\"13837073906\",\"bbrName\":\"吴 双\"},{\"bdNo\":\"390081711066784\",\"tbrPhone\":\"15237044790\",\"bbrPhone\":\"15237044790\",\"bbrName\":\"刘 爱丽\"},{\"bdNo\":\"390081711343373\",\"tbrPhone\":null,\"bbrPhone\":\"18037723106\",\"bbrName\":\"郭家麟\"},{\"bdNo\":\"390081711343393\",\"tbrPhone\":null,\"bbrPhone\":\"18037723106\",\"bbrName\":\"蒋亚楠\"},{\"bdNo\":\"390081711342769\",\"tbrPhone\":\"18736819949\",\"bbrPhone\":\"18736819949\",\"bbrName\":\"李 培瑜\"},{\"bdNo\":\"390081711391443\",\"tbrPhone\":null,\"bbrPhone\":\"18338776663\",\"bbrName\":\"黄莉\"},{\"bdNo\":\"390081711726390\",\"tbrPhone\":null,\"bbrPhone\":\"18336026570\",\"bbrName\":\"尹 小龙\"},{\"bdNo\":\"390081711726408\",\"tbrPhone\":null,\"bbrPhone\":\"18336026570\",\"bbrName\":\"尹 伊诺\"},{\"bdNo\":\"390081711386685\",\"tbrPhone\":\"18337051308\",\"bbrPhone\":\"18337051308\",\"bbrName\":\"闫 启皓\"},{\"bdNo\":\"390081711824933\",\"tbrPhone\":null,\"bbrPhone\":\"15137035956,15137035956\",\"bbrName\":\"朱 向娅\"},{\"bdNo\":\"390081711828247\",\"tbrPhone\":null,\"bbrPhone\":\"18336988503\",\"bbrName\":\"杨 若诗\"},{\"bdNo\":\"390081711736597\",\"tbrPhone\":null,\"bbrPhone\":\"13937012665,13937014160\",\"bbrName\":\"胡 腾戈\"},{\"bdNo\":\"390081711956590\",\"tbrPhone\":\"2759627,15225299514,\",\"bbrPhone\":\"17335341521,17335344521,2759627,15225299514\",\"bbrName\":\"贾梦琳\"},{\"bdNo\":\"390081711832322\",\"tbrPhone\":null,\"bbrPhone\":\"15835283538\",\"bbrName\":\"景 一润\"},{\"bdNo\":\"390081712033184\",\"tbrPhone\":\"18703703441\",\"bbrPhone\":\"18703703441\",\"bbrName\":\"李 欣雅\"},{\"bdNo\":\"390081712142085\",\"tbrPhone\":null,\"bbrPhone\":\"18338753781\",\"bbrName\":\"石 帅\"},{\"bdNo\":\"390081711972215\",\"tbrPhone\":null,\"bbrPhone\":\"18837057772\",\"bbrName\":\"李 思雨\"},{\"bdNo\":\"390081711824965\",\"tbrPhone\":null,\"bbrPhone\":\"15137035956\",\"bbrName\":\"徐 煜博\"},{\"bdNo\":\"390081712155452\",\"tbrPhone\":null,\"bbrPhone\":\"15896963308\",\"bbrName\":\"胡 桂斌\"},{\"bdNo\":\"390081712164879\",\"tbrPhone\":\"15136638689\",\"bbrPhone\":\"15136638689\",\"bbrName\":\"代 凯凯\"},{\"bdNo\":\"390081712242173\",\"tbrPhone\":null,\"bbrPhone\":\"15737095153\",\"bbrName\":\"郑高苹\"},{\"bdNo\":\"390081712233704\",\"tbrPhone\":null,\"bbrPhone\":\"15737095153\",\"bbrName\":\"郑高苹\"},{\"bdNo\":\"390081712170678\",\"tbrPhone\":null,\"bbrPhone\":\"18203705887\",\"bbrName\":\"王 乾旭\"},{\"bdNo\":\"390081712242433\",\"tbrPhone\":null,\"bbrPhone\":\"15836497774\",\"bbrName\":\"张 婧瑶\"},{\"bdNo\":\"390081712303452\",\"tbrPhone\":\"15839092229,\",\"bbrPhone\":\"15839092229\",\"bbrName\":\"曹 家瑶\"},{\"bdNo\":\"390081712259499\",\"tbrPhone\":\"18258989981\",\"bbrPhone\":\"18258989981\",\"bbrName\":\"吕 勇\"},{\"bdNo\":\"390081712308114\",\"tbrPhone\":\"18736777187\",\"bbrPhone\":\"18736777187\",\"bbrName\":\"张哲鸣\"},{\"bdNo\":\"390081812036699\",\"tbrPhone\":\"15939099892\",\"bbrPhone\":\"15939099892\",\"bbrName\":\"杨杰斐\"},{\"bdNo\":\"390081812046631\",\"tbrPhone\":\"15939099892\",\"bbrPhone\":\"15939099892,15939088892\",\"bbrName\":\"杨 钦然\"},{\"bdNo\":\"390081812176932\",\"tbrPhone\":null,\"bbrPhone\":\"15090532998\",\"bbrName\":\"焦 芳梅\"},{\"bdNo\":\"390081911314306\",\"tbrPhone\":\"\",\"bbrPhone\":\"\",\"bbrName\":\"\"},{\"bdNo\":\"390081812331095\",\"tbrPhone\":\"13513704523,18336938288,\",\"bbrPhone\":\"18336938288,13781662739\",\"bbrName\":\"孙 磊\"},{\"bdNo\":\"390081812284468\",\"tbrPhone\":\"13781558705\",\"bbrPhone\":\"13781558705\",\"bbrName\":\"刘舒苒\"},{\"bdNo\":\"390081812179735\",\"tbrPhone\":null,\"bbrPhone\":\"15238562565\",\"bbrName\":\"黄俊翔\"},{\"bdNo\":\"390081911368218\",\"tbrPhone\":\"13523834522\",\"bbrPhone\":\"15156176673\",\"bbrName\":\"赵 海风\"},{\"bdNo\":\"390081911307781\",\"tbrPhone\":\"18256126313\",\"bbrPhone\":\"18736856752,18736856752\",\"bbrName\":\"韩 玲娣\"},{\"bdNo\":\"390081911568373\",\"tbrPhone\":null,\"bbrPhone\":\"13937065274\",\"bbrName\":\"刘 亚威\"},{\"bdNo\":\"390081911872768\",\"tbrPhone\":null,\"bbrPhone\":\"15082977890,15136015342,13526316075\",\"bbrName\":\"刘 娜娜\"},{\"bdNo\":\"390081911885556\",\"tbrPhone\":null,\"bbrPhone\":\"18736856752\",\"bbrName\":\"王 晨歌\"},{\"bdNo\":\"390081911679174\",\"tbrPhone\":null,\"bbrPhone\":\"15237078375\",\"bbrName\":\"郝雨欣\"},{\"bdNo\":\"390081911612392\",\"tbrPhone\":\"13781557728,\",\"bbrPhone\":\"2759627,2759627,13781557728,15225213697,13781557728,2759627,13781557728,5199510\",\"bbrName\":\"刘淑玲\"},{\"bdNo\":\"390081911924221\",\"tbrPhone\":null,\"bbrPhone\":\"18838589895\",\"bbrName\":\"黄 紫欣\"},{\"bdNo\":\"390081911985390\",\"tbrPhone\":null,\"bbrPhone\":\"17105988880\",\"bbrName\":\"岳刘茵\"},{\"bdNo\":\"390081912126797\",\"tbrPhone\":\"17630768921\",\"bbrPhone\":\"17630768921\",\"bbrName\":\"朱 梓秋\"},{\"bdNo\":\"390491609127911\",\"tbrPhone\":\"15978781408,\",\"bbrPhone\":\"13603911073\",\"bbrName\":\"郑 勇\"},{\"bdNo\":\"390491609162501\",\"tbrPhone\":null,\"bbrPhone\":\"15896948894\",\"bbrName\":\"黄 红军\"},{\"bdNo\":\"390491609040881\",\"tbrPhone\":\"5180669,13781561488,13781561488,\",\"bbrPhone\":\"15136001567,13781561488\",\"bbrName\":\"程 晓甜\"},{\"bdNo\":\"390491709541561\",\"tbrPhone\":null,\"bbrPhone\":\"15896963308\",\"bbrName\":\"胡 桂斌\"},{\"bdNo\":\"390081912005475\",\"tbrPhone\":\"15514983111,\",\"bbrPhone\":\"15514983111\",\"bbrName\":\"贾壹\"},{\"bdNo\":\"390491709542291\",\"tbrPhone\":\"13781557728,\",\"bbrPhone\":\"17335341521,17335344521,2759627,15225299514\",\"bbrName\":\"贾梦琳\"},{\"bdNo\":\"390491709617791\",\"tbrPhone\":null,\"bbrPhone\":\"18937088884,13037544470\",\"bbrName\":\"侯 苏杭\"},{\"bdNo\":\"390491709548561\",\"tbrPhone\":null,\"bbrPhone\":\"15518698500,13569311887\",\"bbrName\":\"祝 颂能\"},{\"bdNo\":\"390491709700681\",\"tbrPhone\":\"13803706068\",\"bbrPhone\":\"13803706068\",\"bbrName\":\"秦 怀红\"},{\"bdNo\":\"390491709825861\",\"tbrPhone\":\"5181059,15136042222,\",\"bbrPhone\":\"18236350555,15136042222,15238598765\",\"bbrName\":\"刘 园园\"},{\"bdNo\":\"390491709831041\",\"tbrPhone\":null,\"bbrPhone\":\"18737053776\",\"bbrName\":\"顾 美峰\"},{\"bdNo\":\"390491709837391\",\"tbrPhone\":null,\"bbrPhone\":\"15037023999\",\"bbrName\":\"何彬\"},{\"bdNo\":\"390491709859311\",\"tbrPhone\":\"18037755667\",\"bbrPhone\":\"18037755667\",\"bbrName\":\"王 劝\"},{\"bdNo\":\"390491709842411\",\"tbrPhone\":\"15237088466\",\"bbrPhone\":\"15237088466\",\"bbrName\":\"聂 新建\"},{\"bdNo\":\"390491709944981\",\"tbrPhone\":\"13700701772\",\"bbrPhone\":\"13700701772\",\"bbrName\":\"潘 莉\"},{\"bdNo\":\"ZHZ051EL1302423\",\"tbrPhone\":null,\"bbrPhone\":\"13937023562,13937023562,13937023562\",\"bbrName\":\"黄 文凯\"},{\"bdNo\":\"ZHZ051AL6418195\",\"tbrPhone\":\"13781561766,13781561766,\",\"bbrPhone\":\"13781561766,13781561766\",\"bbrName\":\"杜 永伟\"},{\"bdNo\":\"ZHZ071EL02H6129\",\"tbrPhone\":\"13937065650,\",\"bbrPhone\":\"13937065650\",\"bbrName\":\"杨 莉\"}]";
            JArray bdDetailJArray = JArray.Parse(bdDetailListStr);
            foreach (JObject bdDetailJObj in bdDetailJArray)
            {
                string bdNo = bdDetailJObj["bdNo"].ToString();
                Baodan currentBaodan = bdList.FirstOrDefault(m => m.BaodanNo.Contains(bdNo));
                if (currentBaodan != null)
                {
                    currentBaodan.Users = currentBaodan.Users.Replace("@被保人@", bdDetailJObj.SelectToken("bbrName").ToString());
                    currentBaodan.Phones = currentBaodan.Phones.Replace("@投保人电话@", bdDetailJObj.SelectToken("tbrPhone").ToString());
                    currentBaodan.Phones = currentBaodan.Phones.Replace("@被保人电话@", bdDetailJObj.SelectToken("bbrPhone").ToString());
                }
            }

            IWorkbook workbook = this._excelHelper.CreateOrUpdateWorkbook(bdList);
            this._excelHelper.SaveWorkbookToFile(workbook, @"C:\Users\lixianghong\Desktop\新12月份保单.xlsx");

            this._logger.LogInformation("保单数据处理完成！");
        }

    }

    public class Baodan
    {
        [ExcelTitle("类别")]
        public string Type { get; set; }
        [ExcelTitle("保单号")]
        public string BaodanNo { get; set; }
        [ExcelTitle("相关人")]
        public string Users { get; set; }
        [ExcelTitle("电话")]
        public string Phones { get; set; }
        [ExcelTitle("保项")]
        public string Items { get; set; }
        [ExcelTitle("保费")]
        public string Price { get; set; }
        [ExcelTitle("应缴日期")]
        public string Date { get; set; }
        [ExcelTitle("期数")]
        public string NumberPeriods { get; set; }
    }

}
